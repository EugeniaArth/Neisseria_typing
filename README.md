# Neisseria_typing

Разработка новых схем молекулярного типирования N. gonorrhoeae, для улучшения эпидемиологического мониторинга, отслеживание распространения антибиотико-резистентных штаммов, изучение генетического разнообразия бактерии и создание основы для разработки эффективных методов диагностики, лечения и профилактики гонококковой инфекции.
 
N. gonorrhoeae - культивируемый микроорганизм. В настоящее время ведется типирование по двум основным системам - гипервариабельные гены, входящие в NG-MAST и  MLST включает гены домашнего хозяйства. По первой слишком много генотипов, вторая наоборот слишком консервативная. Позволяет отслеживать распространение и выявить связь с антибиотикорезистентностью

Задача:
Разработать новую систему эпидемиологического контроля за распространением гонококковой инфекции , которая позволит классифицировать штаммы по происхождению, выявить связь с антибиотикорезистентностью, но не будет слишком консервативна/слишком вариабельная, а будет давать меньшее количество типов чтобы легче работать



Этапы. 

1) Подготовка данных - .fasta и .fas изоляты из базы данных PubMLST. 
2) Поиск снипов по протоколу GATK. (Возможно не понадобится).
3)
4)
5)

**Подготовка данных**
Изоляты скачиваются из БД PubMLST, она содержит .fasta и .fas файлы (Но не SRA).  Названия сэмплов и стран, которые были депонированы на диске, анализированы скриптом get_samples_names.py (так как мне достались только папке с файлами, без описания, то пришлось сначала собрать все названия файлов и папок, потом выгрузить данные по ID, которое соответствовало названиям сэмплов всю информацию по ним из БД, в том числе SRA). Таблица analyzed_data.xlsx содержит основные сведения по загруженным файлам

**Поиск снипов по протоколу GATK**
Проводилось в несколько этапов:

1) Скачивание fastq изиспользуя данные Run Accession для каждого изолята. Конфвертированы для удобства в tab-delimited файл for_fasterq-dump.txt. Скрипт для скачивания fasterq-dump.sh
2) Анализ качества полученных исходных данных и тримминг при необходимости. Анализ качества проводим fastqc и multiqc скриптом quality_check.sh. Затем - полученные multiqc файлы скриптом multiqc_analysis.py анализируем для контроля, какие образцы провалили проверку. Результат сохраняется в виде failed_samples.txt (те же скрипты можно использовать для контроля после тримминга, только выбрать другую директорию). Тримминг проводится скриптом trimming.py (обязательно указать путь для файла с адаптерами). После тримминга и повторной проверки, для тех хороших образцов и тех, которые пройдут повторную проверку можно приступать к картированию
3) Картирование на референсный геном проводится bwa mem с последующем конвертированием .sam в .bam, сортировкой и индексированием – скрипт mapping.sh
5) Поиск снипов по протоколу GATK и аннотация выявленных замен. Используем скрипт calling.sh.  Аннотация вариантов проводится при помощи Annovar (https://annovar.openbioinformatics.org/en/latest/user-guide/filter/#overview) - для этого ему нужна база данных dbSNP. Так как для N.gonorrhoeae ее не существует, ее нужно создать по инструкции. Готовая база данных для данного проекта в архиве annovar_db.zip, после разархивирования нужно указать путь к ней в скрипте (Также, если java -jar picard.jar AddOrReplaceReadGroups и подобные не работают, то нужен полный путь к picard.jar).
6) 
   
